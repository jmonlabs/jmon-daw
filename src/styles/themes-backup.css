/* JMON DAW - One Light & One Dark Theme System */

/* ========================================
   Design Tokens - One Light Theme (Default)
   ======================================== */

:root {
    /* One Light Base Colors */
    --one-light-bg: #fafafa;
    --one-light-bg-secondary: #f5f5f5;
    --one-light-bg-tertiary: #eeeeee;
    --one-light-text: #383a42;
    --one-light-text-secondary: #a0a1a7;
    --one-light-text-muted: #9ca0a6;
    --one-light-border: #e5e5e6;
    --one-light-border-light: #f0f0f1;
    
    /* One Light Accent Palette */
    --one-light-red: #e45649;
    --one-light-green: #50a14f;
    --one-light-yellow: #c18401;
    --one-light-blue: #4078f2;
    --one-light-purple: #a626a4;
    --one-light-cyan: #0184bc;
    --one-light-orange: #da6c00;

    /* Core System Colors */
    --color-bg-primary: var(--one-light-bg);
    --color-bg-secondary: var(--one-light-bg-secondary);
    --color-bg-surface: #ffffff;
    --color-bg-elevated: #ffffff;
    --color-bg-modal: #ffffff;
    --color-bg-overlay: rgba(56, 58, 66, 0.8);

    /* Text Colors */
    --color-text-primary: var(--one-light-text);
    --color-text-secondary: var(--one-light-text-secondary);
    --color-text-muted: var(--one-light-text-muted);
    --color-text-inverse: #ffffff;
    --color-text-on-accent: #ffffff;

    /* Border Colors */
    --color-border-primary: var(--one-light-border);
    --color-border-secondary: var(--one-light-border-light);
    --color-border-focus: var(--one-light-blue);
    --color-border-active: var(--one-light-purple);

    /* Accent Colors */
    --color-accent-primary: var(--one-light-purple);
    --color-accent-secondary: var(--one-light-blue);
    --color-accent-tertiary: var(--one-light-cyan);

    /* Button Colors */
    --color-button-primary: var(--one-light-purple);
    --color-button-primary-hover: #8b1a96;
    --color-button-secondary: var(--one-light-bg-secondary);
    --color-button-secondary-hover: var(--one-light-bg-tertiary);
    --color-button-tertiary: transparent;
    --color-button-tertiary-hover: var(--one-light-bg-secondary);
    --color-button-disabled: var(--one-light-bg-tertiary);

    /* Status Colors */
    --color-success: var(--one-light-green);
    --color-warning: var(--one-light-yellow);
    --color-error: var(--one-light-red);
    --color-info: var(--one-light-blue);

    /* DAW Specific Colors */
    --color-track-bg: var(--color-bg-surface);
    --color-track-bg-selected: rgba(166, 38, 164, 0.08);
    --color-track-bg-hover: var(--one-light-bg-secondary);
    --color-track-border: var(--color-border-primary);

    --color-note-bg: var(--one-light-purple);
    --color-note-bg-hover: #8b1a96;
    --color-note-border: var(--one-light-purple);
    --color-note-border-selected: var(--one-light-blue);
    --color-note-text: #ffffff;

    --color-timeline-bg: var(--color-bg-surface);
    --color-timeline-grid: var(--color-border-secondary);
    --color-timeline-ruler: var(--color-bg-elevated);

    --color-playhead: var(--one-light-red);
    --color-loop-region: rgba(64, 120, 242, 0.12);
    --color-loop-border: var(--one-light-blue);

    /* Transport Controls */
    --color-play: var(--one-light-green);
    --color-pause: var(--one-light-yellow);
    --color-stop: var(--one-light-red);
    --color-record: var(--one-light-red);

    /* Effects & Synth Colors */
    --color-synth-bg: var(--one-light-purple);
    --color-synth-text: #ffffff;
    --color-effect-bg: var(--one-light-blue);
    --color-effect-text: #ffffff;
    --color-master-bg: var(--one-light-cyan);
    --color-master-text: #ffffff;

    /* Shadows */
    --shadow-xs: 0 1px 2px 0 rgba(56, 58, 66, 0.05);
    --shadow-sm: 0 1px 3px 0 rgba(56, 58, 66, 0.1), 0 1px 2px 0 rgba(56, 58, 66, 0.06);
    --shadow-md: 0 4px 6px -1px rgba(56, 58, 66, 0.1), 0 2px 4px -1px rgba(56, 58, 66, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(56, 58, 66, 0.1), 0 4px 6px -2px rgba(56, 58, 66, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(56, 58, 66, 0.1), 0 10px 10px -5px rgba(56, 58, 66, 0.04);

    /* Transitions */
    --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;

    /* Border Radius */
    --radius-sm: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --radius-xl: 1rem;
    --radius-full: 9999px;

    /* Typography */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;

    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;

    --line-height-tight: 1.25;
    --line-height-normal: 1.5;
    --line-height-relaxed: 1.75;
}

/* ========================================
   One Dark Theme
   ======================================== */

[data-theme="dark"] {
    /* One Dark Base Colors */
    --one-dark-bg: #282c34;
    --one-dark-bg-secondary: #21252b;
    --one-dark-bg-tertiary: #1e2127;
    --one-dark-text: #abb2bf;
    --one-dark-text-secondary: #5c6370;
    --one-dark-text-muted: #4b5263;
    --one-dark-border: #3e4451;
    --one-dark-border-light: #2c313c;
    
    /* One Dark Accent Palette */
    --one-dark-red: #e06c75;
    --one-dark-green: #98c379;
    --one-dark-yellow: #e5c07b;
    --one-dark-blue: #61afef;
    --one-dark-purple: #c678dd;
    --one-dark-cyan: #56b6c2;
    --one-dark-orange: #d19a66;

    /* Core System Colors */
    --color-bg-primary: var(--one-dark-bg);
    --color-bg-secondary: var(--one-dark-bg-secondary);
    --color-bg-surface: var(--one-dark-bg-secondary);
    --color-bg-elevated: #2c313c;
    --color-bg-modal: #2c313c;
    --color-bg-overlay: rgba(40, 44, 52, 0.9);

    /* Text Colors */
    --color-text-primary: var(--one-dark-text);
    --color-text-secondary: var(--one-dark-text-secondary);
    --color-text-muted: var(--one-dark-text-muted);
    --color-text-inverse: var(--one-dark-bg);
    --color-text-on-accent: var(--one-dark-bg);

    /* Border Colors */
    --color-border-primary: var(--one-dark-border);
    --color-border-secondary: var(--one-dark-border-light);
    --color-border-focus: var(--one-dark-blue);
    --color-border-active: var(--one-dark-purple);

    /* Accent Colors */
    --color-accent-primary: var(--one-dark-purple);
    --color-accent-secondary: var(--one-dark-blue);
    --color-accent-tertiary: var(--one-dark-cyan);

    /* Button Colors */
    --color-button-primary: var(--one-dark-purple);
    --color-button-primary-hover: #be7bd9;
    --color-button-secondary: var(--one-dark-bg-tertiary);
    --color-button-secondary-hover: var(--one-dark-border);
    --color-button-tertiary: transparent;
    --color-button-tertiary-hover: var(--one-dark-bg-tertiary);
    --color-button-disabled: var(--one-dark-border-light);

    /* Status Colors */
    --color-success: var(--one-dark-green);
    --color-warning: var(--one-dark-yellow);
    --color-error: var(--one-dark-red);
    --color-info: var(--one-dark-blue);

    /* DAW Specific Colors */
    --color-track-bg: var(--color-bg-surface);
    --color-track-bg-selected: rgba(198, 120, 221, 0.12);
    --color-track-bg-hover: var(--one-dark-bg-tertiary);
    --color-track-border: var(--color-border-primary);

    --color-note-bg: var(--one-dark-purple);
    --color-note-bg-hover: #be7bd9;
    --color-note-border: var(--one-dark-purple);
    --color-note-border-selected: var(--one-dark-blue);
    --color-note-text: var(--one-dark-bg);

    --color-timeline-bg: var(--color-bg-surface);
    --color-timeline-grid: var(--color-border-secondary);
    --color-timeline-ruler: var(--color-bg-elevated);

    --color-playhead: var(--one-dark-red);
    --color-loop-region: rgba(97, 175, 239, 0.15);
    --color-loop-border: var(--one-dark-blue);

    /* Transport Controls */
    --color-play: var(--one-dark-green);
    --color-pause: var(--one-dark-yellow);
    --color-stop: var(--one-dark-red);
    --color-record: var(--one-dark-red);

    /* Effects & Synth Colors */
    --color-synth-bg: var(--one-dark-purple);
    --color-synth-text: var(--one-dark-bg);
    --color-effect-bg: var(--one-dark-blue);
    --color-effect-text: var(--one-dark-bg);
    --color-master-bg: var(--one-dark-cyan);
    --color-master-text: var(--one-dark-bg);

    /* Shadows for dark theme */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.4), 0 1px 2px 0 rgba(0, 0, 0, 0.3);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.25);
}

/* ========================================
   Legacy Variable Mappings (for compatibility)
   ======================================== */

:root {
    /* Legacy color mappings */
    --bulma-scheme-main: var(--color-bg-primary);
    --bulma-scheme-main-ter: var(--color-bg-elevated);
    --bulma-border: var(--color-border-primary);
    --bulma-primary: var(--color-accent-primary);
    --bulma-danger: var(--color-error);
    --bulma-success: var(--color-success);
    --bulma-warning: var(--color-warning);
    --bulma-info: var(--color-info);

    /* Legacy DAW mappings */
    --surface-bg: var(--color-bg-surface);
    --elevated-bg: var(--color-bg-elevated);
    --track-bg: var(--color-track-bg);
    --track-bg-selected: var(--color-track-bg-selected);
    --border-color: var(--color-border-primary);
    --border-active: var(--color-border-active);
    
    --button-bg: var(--color-button-secondary);
    --button-hover: var(--color-button-secondary-hover);
    
    --text-primary: var(--color-text-primary);
    --text-secondary: var(--color-text-secondary);
    --text-muted: var(--color-text-muted);
    --text-inverse: var(--color-text-inverse);
    
    --primary-accent: var(--color-accent-primary);
    --secondary-accent: var(--color-accent-secondary);
    --danger-accent: var(--color-error);
    --warning-color: var(--color-warning);
    --info-color: var(--color-info);
    --secondary-bg: var(--color-synth-bg);
    
    --note-bg: var(--color-note-bg);
    --note-bg-hover: var(--color-note-bg-hover);
    --note-border: var(--color-note-border);
    --note-border-selected: var(--color-note-border-selected);
    --note-text: var(--color-note-text);
    
    --loop-region: var(--color-loop-region);
    --hover-overlay: rgba(0, 0, 0, 0.05);
    --focus-ring: var(--color-border-focus);
}

[data-theme="dark"] {
    --hover-overlay: rgba(255, 255, 255, 0.1);
}

/* ========================================
   Component Styles
   ======================================== */

/* Base Application */
body {
    background-color: var(--color-bg-primary) !important;
    color: var(--color-text-primary) !important;
    transition: background-color var(--transition-normal), color var(--transition-normal);
}

.daw-container {
    background-color: var(--color-bg-primary) !important;
}

/* Header & Transport */
header {
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-primary) !important;
}

/* Timeline & Ruler */
.timeline-ruler,
.ruler-content {
    background-color: var(--color-timeline-ruler) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-primary) !important;
}

/* Track Components */
.track-row {
    background-color: var(--color-track-bg) !important;
    border-color: var(--color-track-border) !important;
}

.track-row:hover {
    background-color: var(--color-track-bg-hover) !important;
}

.track-row.selected {
    background-color: var(--color-track-bg-selected) !important;
}

.track-info-section {
    background-color: var(--color-track-bg) !important;
    border-color: var(--color-track-border) !important;
}

.track-lane-section {
    background-color: var(--color-timeline-bg) !important;
}

.track-effects-section {
    background-color: var(--color-track-bg) !important;
    border-color: var(--color-track-border) !important;
}

/* Piano Roll & Notes */
.track-lane {
    background-color: var(--color-timeline-bg) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-track-border) !important;
}

.note {
    background-color: var(--color-note-bg) !important;
    border-color: var(--color-note-border) !important;
    color: var(--color-note-text) !important;
}

.note:hover {
    background-color: var(--color-note-bg-hover) !important;
}

/* Buttons */
.button,
.btn {
    background-color: var(--color-button-secondary) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-primary) !important;
    transition: all var(--transition-fast);
}

.button:hover,
.btn:hover {
    background-color: var(--color-button-secondary-hover) !important;
    border-color: var(--color-border-active) !important;
}

.button.is-primary,
.btn-primary {
    background-color: var(--color-button-primary) !important;
    color: var(--color-text-on-accent) !important;
    border-color: var(--color-button-primary) !important;
}

.button.is-primary:hover,
.btn-primary:hover {
    background-color: var(--color-button-primary-hover) !important;
}

/* Transport Controls */
.transport-controls .button {
    background-color: var(--color-button-secondary) !important;
    border-color: var(--color-border-primary) !important;
}

.transport-controls .play-button {
    background-color: var(--color-success) !important;
    color: var(--color-text-on-accent) !important;
}

.transport-controls .stop-button {
    background-color: var(--color-error) !important;
    color: var(--color-text-on-accent) !important;
}

.transport-controls .pause-button {
    background-color: var(--color-warning) !important;
    color: var(--color-text-on-accent) !important;
}

/* Effects & Synth Boxes */
.synth-box {
    background-color: var(--color-synth-bg) !important;
    color: var(--color-synth-text) !important;
}

.effect-box {
    background-color: var(--color-effect-bg) !important;
    color: var(--color-effect-text) !important;
}

.master-box {
    background-color: var(--color-master-bg) !important;
    color: var(--color-master-text) !important;
}

/* Modal & Overlays */
.modal-content,
.dropdown-content {
    background-color: var(--color-bg-modal) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-primary) !important;
    box-shadow: var(--shadow-lg);
}

/* Context Menu */
.context-menu {
    background-color: var(--color-bg-modal) !important;
    border-color: var(--color-border-primary) !important;
    box-shadow: var(--shadow-lg) !important;
}

.context-menu .dropdown-item {
    color: var(--color-text-primary) !important;
}

.context-menu .dropdown-item:hover {
    background-color: var(--color-button-tertiary-hover) !important;
}

/* Form Controls */
input, select, textarea {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-primary) !important;
}

input:focus, select:focus, textarea:focus {
    border-color: var(--color-border-focus) !important;
    box-shadow: 0 0 0 2px rgba(97, 175, 239, 0.2) !important;
}

/* Scrollbars */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--color-bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--color-border-primary);
    border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

/* Selection */
::selection {
    background-color: var(--color-accent-primary);
    color: var(--color-text-on-accent);
}

/* Focus Indicators */
*:focus {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
}

button:focus, .button:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-border-focus);
}

/* Transitions for theme switching */
* {
    transition: background-color var(--transition-normal), 
                color var(--transition-normal), 
                border-color var(--transition-normal);
}

/* Utility Classes */
.bg-surface { background-color: var(--color-bg-surface) !important; }
.bg-elevated { background-color: var(--color-bg-elevated) !important; }
.text-primary { color: var(--color-text-primary) !important; }
.text-secondary { color: var(--color-text-secondary) !important; }
.text-muted { color: var(--color-text-muted) !important; }
.border-primary { border-color: var(--color-border-primary) !important; }
.accent-primary { color: var(--color-accent-primary) !important; }
.accent-bg { background-color: var(--color-accent-primary) !important; }

/* High Contrast for Critical Elements */
.critical-control {
    border: 2px solid var(--color-accent-primary) !important;
    box-shadow: var(--shadow-md);
}

.recording-indicator {
    background-color: var(--color-error) !important;
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}
    --shadow-none: none;

    /* Transitions */
    --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    /* Spacing */
    --space-1: 0.25rem; /* 4px */
    --space-2: 0.5rem; /* 8px */
    --space-3: 0.75rem; /* 12px */
    --space-4: 1rem; /* 16px */
    --space-5: 1.25rem; /* 20px */
    --space-6: 1.5rem; /* 24px */
    --space-8: 2rem; /* 32px */
    --space-10: 2.5rem; /* 40px */
    --space-12: 3rem; /* 48px */

    /* Border Radius */
    --radius-sm: 0.375rem; /* 6px */
    --radius-md: 0.5rem; /* 8px */
    --radius-lg: 0.75rem; /* 12px */
    --radius-xl: 1rem; /* 16px */
    --radius-full: 9999px;

    /* Typography */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;

    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;

    --line-height-tight: 1.25;
    --line-height-normal: 1.5;
    --line-height-relaxed: 1.75;
}

/* ========================================
   Dark Theme - Oasis Palette
   ======================================== */

[data-theme="dark"] {
    /* Dark Colors */
    --dark-50: #f8fafc;
    --dark-100: #f1f5f9;
    --dark-200: #e2e8f0;
    --dark-300: #cbd5e1;
    --dark-400: #94a3b8;
    --dark-500: #64748b;
    --dark-600: #475569;
    --dark-700: #334155;
    --dark-800: #1e293b;
    --dark-900: #0f172a;

    /* Oasis Dark Accent Colors */
    --oasis-1: #4c908b;
    --oasis-2: #7bc1a9;
    --oasis-3: #f1e0b6;
    --oasis-4: #e1a66b;
    --oasis-5: #d75c28;

    /* Dark Theme Variables */
    --color-bg-primary: var(--dark-900);
    --color-bg-secondary: var(--dark-800);
    --color-bg-tertiary: var(--dark-700);
    --color-bg-elevated: var(--dark-700);
    --color-bg-surface: var(--dark-800);

    --color-text-primary: var(--dark-50);
    --color-text-secondary: var(--dark-300);
    --color-text-tertiary: var(--dark-400);
    --color-text-inverse: var(--dark-900);
    --color-text-on-accent: var(--dark-900);

    --color-border-primary: var(--dark-600);
    --color-border-secondary: var(--dark-500);
    --color-border-focus: var(--oasis-2);
    --color-border-active: var(--oasis-2);

    --color-accent-primary: var(--oasis-2);
    --color-accent-primary-hover: var(--oasis-3);
    --color-accent-secondary: var(--oasis-4);
    --color-accent-tertiary: var(--oasis-1);
    --color-accent-quaternary: var(--oasis-5);

    --color-button-primary: var(--oasis-2);
    --color-button-primary-hover: var(--oasis-3);
    --color-button-secondary: var(--oasis-1);
    --color-button-secondary-hover: var(--oasis-4);
    --color-button-tertiary: transparent;
    --color-button-tertiary-hover: var(--dark-700);
    --color-button-disabled: var(--dark-700);

    --color-status-success: var(--oasis-2);
    --color-status-warning: var(--oasis-4);
    --color-status-error: var(--oasis-5);
    --color-status-info: var(--oasis-1);

    /* Track & Timeline Colors */
    --color-track-bg: var(--color-bg-surface);
    --color-track-hover: var(--dark-700);
    --color-track-selected: rgba(76, 144, 139, 0.1);
    --color-track-border: var(--dark-600);

    --color-note-bg: var(--oasis-2);
    --color-note-border: var(--oasis-1);
    --color-note-hover: var(--oasis-3);
    --color-note-selected: var(--oasis-4);

    --color-timeline-bg: var(--oasis-1);
    --color-timeline-grid: var(--dark-600);
    --color-timeline-beat: var(--dark-500);
    --color-timeline-bar: var(--dark-400);

    --color-playhead: var(--oasis-5);
    --color-loop-region: rgba(76, 144, 139, 0.15);
    --color-loop-border: var(--oasis-2);

    /* Shadows for dark theme */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
    --shadow-md:
        0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
    --shadow-lg:
        0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);

    /* Override any light backgrounds that might leak through */
    --bulma-scheme-main: var(--dark-900);
    --bulma-scheme-main-ter: var(--dark-800);
    --bulma-border: var(--dark-600);
    --surface-bg: var(--color-bg-surface);
    --elevated-bg: var(--color-bg-elevated);
    --button-bg: var(--color-button-secondary);
    --border-color: var(--color-border-primary);
    --text-primary: var(--color-text-primary);
    --text-secondary: var(--color-text-secondary);
    --text-muted: var(--color-text-tertiary);
    --primary-accent: var(--color-accent-primary);
    --secondary-accent: var(--color-accent-secondary);
}

[data-theme="dark"] body {
    background-color: var(--color-bg-primary) !important;
    color: var(--color-text-primary) !important;
}

[data-theme="dark"] .daw-container {
    background-color: var(--color-bg-primary) !important;
}

[data-theme="dark"] .timeline-ruler {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
}

[data-theme="dark"] .timeline-ruler > div {
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-primary) !important;
}

[data-theme="dark"] .track-info-section {
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-primary) !important;
}

[data-theme="dark"] .track-lane-section {
    background-color: var(--color-bg-surface) !important;
}

[data-theme="dark"] .track-effects-section {
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-primary) !important;
}

[data-theme="dark"] .track-row {
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-primary) !important;
}

[data-theme="dark"] .track-row:hover {
    background-color: var(--color-track-hover) !important;
}

[data-theme="dark"] .piano-roll,
[data-theme="dark"] .piano-key,
[data-theme="dark"] .track-lane,
[data-theme="dark"] .track-header {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-primary) !important;
}

[data-theme="dark"] .header-spacer,
[data-theme="dark"] .ruler-content,
[data-theme="dark"] .track-info,
[data-theme="dark"] .track-controls {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
}

/* Fix any remaining light backgrounds in dark mode */
[data-theme="dark"] div[style*="background-color: #"],
[data-theme="dark"] div[style*="background: #"] {
    background-color: var(--color-bg-surface) !important;
}

/* ========================================
   Button System - Unified & Consistent
   ======================================== */

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    border: 1px solid transparent;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    line-height: var(--line-height-tight);
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
    white-space: nowrap;
    user-select: none;
    outline: none;
    min-height: 2rem;
    background-color: var(--color-button-secondary);
    color: var(--color-text-primary);
}

.btn:focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}

.btn:hover:not(:disabled) {
    background-color: var(--color-button-secondary-hover);
    transform: translateY(-1px);
}

.btn:active:not(:disabled) {
    transform: translateY(0);
}

/* Primary Button */
.btn-primary {
    background-color: var(--color-button-primary);
    color: var(--color-text-on-accent);
    border-color: var(--color-button-primary);
}

.btn-primary:hover:not(:disabled) {
    background-color: var(--color-button-primary-hover);
    border-color: var(--color-button-primary-hover);
}

/* Secondary Button */
.btn-secondary {
    background-color: var(--color-button-secondary);
    color: var(--color-text-primary);
    border-color: var(--color-border-primary);
}

.btn-secondary:hover:not(:disabled) {
    background-color: var(--color-button-secondary-hover);
    border-color: var(--color-border-secondary);
}

/* Tertiary Button */
.btn-tertiary {
    background-color: var(--color-button-tertiary);
    color: var(--color-text-secondary);
    border-color: transparent;
}

.btn-tertiary:hover:not(:disabled) {
    background-color: var(--color-button-tertiary-hover);
    color: var(--color-text-primary);
}

/* Toggle Button */
.btn-toggle {
    background-color: var(--color-button-tertiary);
    color: var(--color-text-secondary);
    border-color: var(--color-border-primary);
}

.btn-toggle:hover:not(:disabled) {
    background-color: var(--color-button-tertiary-hover);
    border-color: var(--color-border-secondary);
}

.btn-toggle.active {
    background-color: var(--color-accent-primary);
    color: var(--color-text-on-accent);
    border-color: var(--color-accent-primary);
}

.btn-toggle.active:hover:not(:disabled) {
    background-color: var(--color-accent-primary-hover);
    border-color: var(--color-accent-primary-hover);
}

/* Button Groups */
.btn-group {
    display: inline-flex;
    border-radius: var(--radius-sm);
    overflow: hidden;
    border: 1px solid var(--color-border-primary);
}

.btn-group .btn {
    border: none;
    border-radius: 0;
    border-right: 1px solid var(--color-border-primary);
}

.btn-group .btn:last-child {
    border-right: none;
}

/* Icon Only Button */
.btn-icon {
    padding: var(--space-2);
    min-width: 2rem;
    aspect-ratio: 1;
}

/* Button Sizes */
.btn-sm {
    padding: var(--space-1) var(--space-2);
    font-size: var(--font-size-xs);
    min-height: 1.5rem;
}

.btn-lg {
    padding: var(--space-3) var(--space-4);
    font-size: var(--font-size-base);
    min-height: 2.5rem;
}

/* ========================================
   Base Styles - Modern & Clean
   ======================================== */

* {
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: var(--line-height-normal);
    color: var(--color-text-primary);
    background-color: var(--color-bg-primary);
    margin: 0;
    padding: 0;
}

.input, .textarea, .select select {
    background-color: var(--color-bg-surface);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-md);
    padding: 0.5rem 0.75rem;
    font-size: var(--font-size-sm);
    transition: all var(--transition-fast);
}

.input:focus, .textarea:focus, .select select:focus {
    border-color: var(--color-border-focus);
    outline: none;
    box-shadow: 0 0 0 2px rgba(209, 123, 140, 0.1);
}

/* ========================================
   Input Components
   ======================================== */

.input {
    display: block;
    width: 100%;
    padding: var(--space-2) var(--space-3);
    background-color: var(--color-bg-surface);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    line-height: var(--line-height-tight);
    transition: all var(--transition-fast);
    outline: none;
}

.input:focus {
    border-color: var(--color-border-focus);
    box-shadow: 0 0 0 3px rgba(209, 123, 140, 0.1);
}

.input::placeholder {
    color: var(--color-text-tertiary);
}

/* ========================================
   Card Components
   ======================================== */

.card {
    background-color: var(--color-bg-surface);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-md);
    overflow: hidden;
}

.card-header {
    padding: var(--space-4);
    border-bottom: 1px solid var(--color-border-primary);
    background-color: var(--color-bg-secondary);
}

.card-body {
    padding: var(--space-4);
}

.card-footer {
    padding: var(--space-4);
    border-top: 1px solid var(--color-border-primary);
    background-color: var(--color-bg-secondary);
}

/* ========================================
   Typography
   ======================================== */

h1,
h2,
h3,
h4,
h5,
h6 {
    margin: 0;
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-tight);
    color: var(--color-text-primary);
}

h1 {
    font-size: var(--font-size-xl);
}
h2 {
    font-size: var(--font-size-lg);
}
h3 {
    font-size: var(--font-size-base);
}
h4 {
    font-size: var(--font-size-sm);
}

p {
    margin: 0;
    color: var(--color-text-secondary);
    line-height: var(--line-height-normal);
}

.text-primary {
    color: var(--color-text-primary);
}
.text-secondary {
    color: var(--color-text-secondary);
}
.text-tertiary {
    color: var(--color-text-tertiary);
}
.text-inverse {
    color: var(--color-text-inverse);
}

.text-xs {
    font-size: var(--font-size-xs);
}
.text-sm {
    font-size: var(--font-size-sm);
}
.text-base {
    font-size: var(--font-size-base);
}
.text-lg {
    font-size: var(--font-size-lg);
}

.font-normal {
    font-weight: var(--font-weight-normal);
}
.font-medium {
    font-weight: var(--font-weight-medium);
}
.font-semibold {
    font-weight: var(--font-weight-semibold);
}
.font-bold {
    font-weight: var(--font-weight-bold);
}

/* Monospace for code/numbers */
.font-mono {
    font-family:
        "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas,
        "Courier New", monospace;
}

/* ========================================
   Utility Classes
   ======================================== */

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Spacing */
.m-0 {
    margin: 0;
}
.p-0 {
    padding: 0;
}
.px-2 {
    padding-left: var(--space-2);
    padding-right: var(--space-2);
}
.py-2 {
    padding-top: var(--space-2);
    padding-bottom: var(--space-2);
}
.px-3 {
    padding-left: var(--space-3);
    padding-right: var(--space-3);
}
.py-3 {
    padding-top: var(--space-3);
    padding-bottom: var(--space-3);
}

/* Flexbox */
.flex {
    display: flex;
}
.flex-col {
    flex-direction: column;
}
.items-center {
    align-items: center;
}
.justify-center {
    justify-content: center;
}
.justify-between {
    justify-content: space-between;
}
.gap-1 {
    gap: var(--space-1);
}
.gap-2 {
    gap: var(--space-2);
}
.gap-3 {
    gap: var(--space-3);
}
.gap-4 {
    gap: var(--space-4);
}

/* Borders */
.border {
    border: 1px solid var(--color-border-primary);
}
.border-0 {
    border: none;
}
.rounded {
    border-radius: var(--radius-sm);
}
.rounded-md {
    border-radius: var(--radius-md);
}
.rounded-lg {
    border-radius: var(--radius-lg);
}

/* Backgrounds */
.bg-primary {
    background-color: var(--color-bg-primary);
}
.bg-secondary {
    background-color: var(--color-bg-secondary);
}
.bg-surface {
    background-color: var(--color-bg-surface);
}

/* ========================================
      Legacy CSS Variables for Compatibility
      ======================================== */

/* Map new design tokens to old variable names for existing components */
:root {
    /* Legacy background variables */
    --primary-bg: var(--color-bg-primary);
    --secondary-bg: var(--color-bg-secondary);
    --surface-bg: var(--color-bg-surface);
    --elevated-bg: var(--color-bg-elevated);

    /* Legacy text variables */
    --text-primary: var(--color-text-primary);
    --text-secondary: var(--color-text-secondary);
    --text-muted: var(--color-text-tertiary);
    --text-inverse: var(--color-text-inverse);

    /* Legacy border variables */
    --border-color: var(--color-border-primary);
    --border-active: var(--color-border-focus);

    /* Legacy accent variables */
    --primary-accent: var(--color-accent-primary);
    --secondary-accent: var(--color-accent-secondary);
    --danger-accent: var(--color-status-error);

    /* Legacy button variables */
    --button-bg: var(--color-button-secondary);
    --button-hover: var(--color-button-secondary-hover);
    --button-active: var(--color-button-primary);
    --button-disabled: var(--color-button-disabled);

    /* Legacy status variables */
    --success-color: var(--color-status-success);
    --warning-color: var(--color-status-warning);
    --error-color: var(--color-status-error);
    --info-color: var(--color-status-info);

    /* Legacy track variables */
    --track-bg: var(--color-track-bg);
    --track-selected: var(--color-track-selected);
    --track-hover: var(--color-track-hover);

    /* Legacy note variables */
    --note-bg: var(--color-note-bg);
    --note-border: var(--color-note-border);
    --note-selected: var(--color-note-selected);
    --note-hover: var(--color-note-hover);

    /* Legacy timeline variables */
    --timeline-bg: var(--color-timeline-bg);
    --timeline-grid: var(--color-timeline-grid);
    --timeline-beat: var(--color-timeline-beat);
    --playhead-color: var(--color-playhead);
    --loop-region: var(--color-loop-region);

    /* Legacy spacing and radius */
    --spacing-xs: var(--space-1);
    --spacing-sm: var(--space-2);
    --spacing-md: var(--space-3);
    --spacing-lg: var(--space-4);
    --spacing-xl: var(--space-6);

    --radius-sm: var(--radius-sm);
    --radius-md: var(--radius-md);
    --radius-lg: var(--radius-lg);

    /* Legacy transitions */
    --transition-fast: var(--transition-fast);
    --transition-normal: var(--transition-normal);
    --transition-slow: var(--transition-slow);

    /* Legacy shadows */
    --shadow-sm: var(--shadow-sm);
    --shadow-md: var(--shadow-md);
    --shadow-lg: var(--shadow-lg);
    --shadow-xl: var(--shadow-none);
    --shadow-none: none;

    /* Legacy hover effects */
    --hover-overlay: rgba(0, 0, 0, 0.05);
    --focus-ring: rgba(209, 123, 140, 0.25);
}

[data-theme="dark"] {
    --hover-overlay: rgba(255, 255, 255, 0.05);
    --focus-ring: rgba(123, 193, 169, 0.4);
}

/* ========================================
      Component Overrides - Clean Bulma
      ======================================== */

/* Reset and apply our button styles to Bulma buttons */
.button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background-color: var(--color-button-secondary) !important;
    color: var(--color-text-primary) !important;
    border: 1px solid var(--color-border-primary) !important;
    border-radius: var(--radius-sm) !important;
    font-size: var(--font-size-sm) !important;
    font-weight: var(--font-weight-medium) !important;
    line-height: var(--line-height-tight) !important;
    cursor: pointer !important;
    transition: all var(--transition-fast) !important;
    text-decoration: none !important;
    white-space: nowrap !important;
    user-select: none !important;
    outline: none !important;
    min-height: 2rem !important;
    box-shadow: none !important;
}

.button:hover:not(:disabled) {
    background-color: var(--color-button-secondary-hover) !important;
    border-color: var(--color-border-secondary) !important;
    transform: none !important;
}

.button:focus-visible {
    outline: 2px solid var(--color-border-focus) !important;
    outline-offset: 2px !important;
}

.button:disabled {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
    pointer-events: none !important;
}

.button.is-primary {
    background-color: var(--color-button-primary) !important;
    color: var(--color-text-on-accent) !important;
    border-color: var(--color-button-primary) !important;
}

.button.is-primary:hover:not(:disabled) {
    background-color: var(--color-button-primary-hover) !important;
    border-color: var(--color-button-primary-hover) !important;
}

.button.is-info {
    background-color: var(--color-status-info) !important;
    color: var(--color-text-on-accent) !important;
    border-color: var(--color-status-info) !important;
}

.button.is-success {
    background-color: var(--color-status-success) !important;
    color: var(--color-text-on-accent) !important;
    border-color: var(--color-status-success) !important;
}

.button.is-warning {
    background-color: var(--color-status-warning) !important;
    color: var(--color-text-inverse) !important;
    border-color: var(--color-status-warning) !important;
}

.button.is-danger {
    background-color: var(--color-status-error) !important;
    color: var(--color-text-on-accent) !important;
    border-color: var(--color-status-error) !important;
}

/* Input overrides */
.input,
.textarea,
.select select {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
    border: 1px solid var(--color-border-primary) !important;
    border-radius: var(--radius-sm) !important;
    font-size: var(--font-size-sm) !important;
    line-height: var(--line-height-tight) !important;
    transition: all var(--transition-fast) !important;
    outline: none !important;
    box-shadow: none !important;
}

.input:focus,
.textarea:focus,
.select select:focus {
    border-color: var(--color-border-focus) !important;
    box-shadow: 0 0 0 3px rgba(209, 123, 140, 0.1) !important;
}

.input::placeholder {
    color: var(--color-text-tertiary) !important;
}

/* Remove all Bulma box shadows and transforms */
.button,
.input,
.textarea,
.select select,
.dropdown-content,
.modal-card,
.notification,
.card {
    box-shadow: none !important;
    transform: none !important;
}

.button:hover:not(:disabled),
.dropdown-item:hover {
    transform: none !important;
    box-shadow: none !important;
}

/* Navbar overrides */
.navbar {
    background-color: var(--color-bg-surface) !important;
    border-bottom: 1px solid var(--color-border-primary) !important;
    box-shadow: none !important;
}

.navbar-item {
    color: var(--color-text-primary) !important;
}

.navbar-item:hover {
    background-color: var(--hover-overlay) !important;
}

/* Dropdown overrides */
.dropdown-content {
    background-color: var(--color-bg-surface) !important;
    border: 1px solid var(--color-border-primary) !important;
    border-radius: var(--radius-md) !important;
    box-shadow: var(--shadow-md) !important;
}

.dropdown-item {
    color: var(--color-text-primary) !important;
    padding: var(--space-2) var(--space-3) !important;
}

.dropdown-item:hover {
    background-color: var(--hover-overlay) !important;
}

/* Tag overrides */
.tag {
    border-radius: var(--radius-sm) !important;
    font-weight: var(--font-weight-normal) !important;
}

.tag.is-dark {
    background-color: var(--color-bg-elevated) !important;
    color: var(--color-text-primary) !important;
}

.tag.is-primary {
    background-color: var(--color-accent-primary) !important;
    color: var(--color-text-on-accent) !important;
}

/* Track and timeline specific styles */
.track-row {
    background-color: var(--color-track-bg) !important;
    border-bottom: 1px solid var(--color-track-border) !important;
    transition: background-color var(--transition-fast) !important;
}

.track-row:hover {
    background-color: var(--color-track-hover) !important;
}

.track-row.selected {
    background-color: var(--color-track-selected) !important;
    border-color: var(--color-border-active) !important;
}

.track-info-section {
    background-color: var(--color-track-bg) !important;
    border-right: 1px solid var(--color-track-border) !important;
}

.track-effects-section {
    background-color: var(--color-track-bg) !important;
    border-left: 1px solid var(--color-track-border) !important;
}

.timeline-ruler {
    background-color: var(--color-timeline-bg) !important;
    border-bottom: 1px solid var(--color-border-primary) !important;
}

/* Note styles */
.note {
    background-color: var(--color-note-bg) !important;
    color: var(--color-text-on-accent) !important;
    border: 1px solid var(--color-note-border) !important;
    border-radius: var(--radius-sm) !important;
    transition: all var(--transition-fast) !important;
    opacity: 0.9 !important;
}

.note:hover {
    background-color: var(--color-note-hover) !important;
    opacity: 1 !important;
    transform: translateY(-1px) !important;
}

.note.selected {
    background-color: var(--color-note-selected) !important;
    border: 2px solid var(--color-text-on-accent) !important;
    opacity: 1 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
}

/* Grid and timeline elements */
.grid-line {
    stroke: var(--color-timeline-grid) !important;
    stroke-width: 1px !important;
}

.grid-line.beat {
    stroke: var(--color-timeline-beat) !important;
    stroke-width: 1px !important;
}

.playhead {
    background-color: var(--color-playhead) !important;
    width: 2px !important;
}

.loop-region {
    background-color: var(--color-loop-region) !important;
    border: 1px solid var(--color-loop-border) !important;
    border-radius: var(--radius-sm) !important;
}

/* Override Bulma background helpers */
.has-background-dark,
.has-background-grey-darker,
.has-background-grey-dark {
    background-color: var(--color-bg-surface) !important;
}

/* Override Bulma text helpers */
.has-text-light {
    color: var(--color-text-primary) !important;
}

.has-text-grey-light {
    color: var(--color-text-secondary) !important;
}

.has-text-grey-lighter {
    color: var(--color-text-tertiary) !important;
}

/* ========================================
   Scrollbars - Minimal & Consistent
   ======================================== */

::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--color-bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--color-border-secondary);
    border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--color-border-focus);
}

::-webkit-scrollbar-corner {
    background: var(--color-bg-secondary);
}

/* Firefox scrollbars */
* {
    scrollbar-width: thin;
    scrollbar-color: var(--color-border-secondary) var(--color-bg-secondary);
}

/* ========================================
   Layout Fixes - Remove grey band and improve spacing
   ======================================== */

/* Timeline ruler should use consistent background */
.timeline-ruler {
    background-color: var(--color-bg-surface) !important;
    border-bottom: 1px solid var(--color-border-primary) !important;
}

/* Ensure no extra spacing between header and main content */
.daw-container header + main {
    margin-top: 0 !important;
    padding-top: 0 !important;
}

/* Tracks container should have proper scrolling */
.tracks-container {
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: thin;
    scrollbar-color: var(--color-border-secondary) var(--color-bg-secondary);
}
